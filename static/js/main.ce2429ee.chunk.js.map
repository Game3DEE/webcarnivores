{"version":3,"sources":["kaitai/C3df.js","kaitai/Vertex.js","kaitai/Face.js","legacy/hunt.ts","Player.tsx","WrapPromise.tsx","pages/Home.tsx","components/Canvas.tsx","pages/MapEditor.tsx","pages/ModelEditor.tsx","App.tsx","reportWebVitals.ts","index.tsx","kaitai/Map.js","kaitai/Rsc.js","kaitai/carnivores_map.js"],"names":["root","factory","define","undefined","this","KaitaiStream","Vertex","Face","C3df","_io","_parent","_root","_read","prototype","vertCount","readU4le","faceCount","nodeCount","textureSize","faces","Array","i","vertices","nodes","Node","textureData","readBytes","textureWidth","textureHeight","name","bytesToStr","bytesTerminate","x","readF4le","y","z","owner","readS2le","hide","readU2le","Object","defineProperty","get","_m_textureWidth","_m_textureHeight","Math","floor","amd","module","exports","require","v1","v2","v3","tax","readS4le","tbx","tcx","tay","tby","tcy","fDoubleSide","readBitsIntBe","fDarkBack","fOpacity","fMortal","fPhong","fEnvmap","fNeedvc","fUnused","fDarkFront","alignToByte","dMask","distant","next","group","reserved","areaPath","createTextureArray","rsc","data","Uint16Array","textureCount","textures","width","height","offset","j","pixel","r","g","b","tex","DataTexture2DArray","type","UnsignedShort565Type","format","RGBFormat","wrapT","wrapS","RepeatWrapping","createInstancedModels","map","parent","matrices","mapSize","halfMapSize","getHeight","heightMap","yScale","matrix","Matrix4","obj","objectMap","makeTranslation","tileSize","push","apply","toArray","indicator","Mesh","SphereBufferGeometry","MeshBasicMaterial","color","position","set","add","models","forEach","mdl","count","length","geo","BufferGeometry","uv","index","idx","f","a","c","setAttribute","Float32BufferAttribute","setIndex","computeVertexNormals","createGeometry","model","texData","DataTexture","RGBAFormat","UnsignedShort5551Type","needsUpdate","createTexture","mesh","InstancedMesh","fog","transparent","alphaTest","fromArray","setMatrixAt","buildVertexMap","Uint8Array","dayLightMap","RGIntegerFormat","UnsignedByteType","internalFormat","buildFragmentMap","flags","flagsMap","textureMap1","textureMap2","fTexDirection","fReverse","RGBIntegerFormat","area","getHeightAt","cx","cy","dx","dy","h1","h2","h3","h4","scene","Group","fetch","then","body","arrayBuffer","mapBuffer","rscBuffer","MAP","RSC","version","console","log","PlaneBufferGeometry","rotateX","PI","heightmapMatrix","multiplyMatrices","makeScale","mat","defines","onBeforeCompile","s","vertexMap","fragmentMap","uniforms","value","vs","vertexShader","replace","fs","fragmentShader","controls","forward","backward","left","right","run","handleKeys","event","down","key","toLowerCase","Player","React","useEffect","document","addEventListener","removeEventListener","velocity","Vector3","direction","_vector","clock","Clock","useFrame","camera","delta","getDelta","Number","normalize","setFromMatrixColumn","addScaledVector","crossVectors","up","wrapPromise","promise","response","status","suspender","res","err","read","resource","loadArea","Terrain","object","Home","shadows","linear","fov","near","far","Stats","PointerLockControls","fallback","Html","center","Canvas","drawContent","props","canvasRef","useRef","canvas","current","context","getContext","fillStyle","fillRect","ref","generateHeightmap","field","imageData","ImageData","BitSelect","bitCount","onChange","parseFloat","target","fill","_","MapEditor","useState","setMap","mapName","setMapName","bitR","setBitR","bitG","setBitG","bitB","setBitB","mode","setMode","getImageData","bitToColorChannel","bit","val","generateFlagsMap","onDragOver","ev","preventDefault","onDrop","dataTransfer","files","url","URL","createObjectURL","buf","style","margin","userSelect","parseInt","onClick","createElement","ctx","putImageData","dataImage","toDataURL","link","click","ModelEditor","App","exact","path","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","getElementById","Map","readU1","FlagsV1","FlagsV2","dawnLightMap","nightLightMap","waterMap","objectHeightMap","fogsMap","ambientMap","readBitsIntLe","fModelDirection","fNoWay","fWater","unused1","fTex2Direction","unused2","fWater2","_m_mapSize","_m_yScale","_m_version","size","_m_tileSize","_m_isValid","Rsc","AudioReverb","freeze","GENERIC","PLATE","FOREST","MOUNTAIN","CANYON","CAVE","SPECIAL2","UNUSED","0","1","2","3","4","5","6","7","modelCount","dawnSkyRgb","Rgb","daySkyRgb","nightSkyRgb","dawnSkyTRgb","daySkyTRgb","nightSkyTRgb","Texture","Model","dawnSkyTexture","skyTextureWidth","skyTextureHeight","daySkyTexture","nightSkyTexture","cloudsMap","fogCount","fogList","FogEntry","randomSoundCount","randomSounds","RandomSound","ambientSoundCount","ambientSounds","AmbientSound","waterCount","waters","Water","radius","yLo","yHi","lineLength","lIntensity","circleRad","cIntensity","fPlaceWater","fPlaceGround","fPlaceUser","fCircle","fBound","fNoBmp","fNoLight","fDefaultLight","fGroundLight","fNoSoft","fNoSoft2","fIsAnimated","grRad","refLight","lastAniTime","boundR","billboard","animation","ModelAnimation","Trd","rNumber","rVolume","rFrequency","rEnvironment","rfNotAtNight","rfUnused","vc0","vc1","vc2","kps","frameCount","frames","textureIndex","level","opacity","fogRgb","yBegin","mortal","transp","fLimit","pcmSize","pcm","rData","rsfxCount","aVolume","_m_width","_m_height","_m_skyTextureWidth","_m_skyTextureHeight","Carnivores1Map","isV1","lightMap","isV2","_m_isV1","_m_isV2"],"mappings":"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","file":"static/js/main.ce2429ee.chunk.js","sourcesContent":["// This is a generated file! Please edit source .ksy file and use kaitai-struct-compiler to rebuild\nconst define = undefined, self = undefined;\n(function (root, factory) {\n  if (typeof define === 'function' && define.amd) {\n    define(['kaitai-struct/KaitaiStream', './Vertex', './Face'], factory);\n  } else if (typeof module === 'object' && module.exports) {\n    module.exports = factory(require('kaitai-struct/KaitaiStream'), require('./Vertex'), require('./Face'));\n  } else {\n    root.C3df = factory(root.KaitaiStream, root.Vertex, root.Face);\n  }\n}(typeof self !== 'undefined' ? self : this, function (KaitaiStream, Vertex, Face) {\n/**\n * @see {@link https://carnivores.fandom.com/wiki/3DF|Source}\n */\n\nvar C3df = (function() {\n  function C3df(_io, _parent, _root) {\n    this._io = _io;\n    this._parent = _parent;\n    this._root = _root || this;\n\n    this._read();\n  }\n  C3df.prototype._read = function() {\n    this.vertCount = this._io.readU4le();\n    this.faceCount = this._io.readU4le();\n    this.nodeCount = this._io.readU4le();\n    this.textureSize = this._io.readU4le();\n    this.faces = new Array(this.faceCount);\n    for (var i = 0; i < this.faceCount; i++) {\n      this.faces[i] = new Face(this._io, this, null);\n    }\n    this.vertices = new Array(this.vertCount);\n    for (var i = 0; i < this.vertCount; i++) {\n      this.vertices[i] = new Vertex(this._io, this, null);\n    }\n    this.nodes = new Array(this.nodeCount);\n    for (var i = 0; i < this.nodeCount; i++) {\n      this.nodes[i] = new Node(this._io, this, this._root);\n    }\n    this.textureData = this._io.readBytes(((this.textureWidth * this.textureHeight) * 2));\n  }\n\n  var Node = C3df.Node = (function() {\n    function Node(_io, _parent, _root) {\n      this._io = _io;\n      this._parent = _parent;\n      this._root = _root || this;\n\n      this._read();\n    }\n    Node.prototype._read = function() {\n      this.name = KaitaiStream.bytesToStr(KaitaiStream.bytesTerminate(this._io.readBytes(32), 0, false), \"utf8\");\n      this.x = this._io.readF4le();\n      this.y = this._io.readF4le();\n      this.z = this._io.readF4le();\n      this.owner = this._io.readS2le();\n      this.hide = this._io.readU2le();\n    }\n\n    return Node;\n  })();\n  Object.defineProperty(C3df.prototype, 'textureWidth', {\n    get: function() {\n      if (this._m_textureWidth !== undefined)\n        return this._m_textureWidth;\n      this._m_textureWidth = 256;\n      return this._m_textureWidth;\n    }\n  });\n  Object.defineProperty(C3df.prototype, 'textureHeight', {\n    get: function() {\n      if (this._m_textureHeight !== undefined)\n        return this._m_textureHeight;\n      this._m_textureHeight = Math.floor(Math.floor(this.textureSize / 2) / this.textureWidth);\n      return this._m_textureHeight;\n    }\n  });\n\n  return C3df;\n})();\nreturn C3df;\n}));\n","// This is a generated file! Please edit source .ksy file and use kaitai-struct-compiler to rebuild\nconst define = undefined; // IRA\n\n(function (root, factory) {\n    if (typeof define === 'function' && define.amd) {\n      define(['kaitai-struct/KaitaiStream'], factory);\n    } else if (typeof module === 'object' && module.exports) {\n      module.exports = factory(require('kaitai-struct/KaitaiStream'));\n    } else {\n      root.Vertex = factory(root.KaitaiStream);\n    }\n  }(this, function (KaitaiStream) {\n  /**\n   * @see {@link https://carnivores.fandom.com/wiki/3DF|Source}\n   */\n  \n  var Vertex = (function() {\n    function Vertex(_io, _parent, _root) {\n      this._io = _io;\n      this._parent = _parent;\n      this._root = _root || this;\n  \n      this._read();\n    }\n    Vertex.prototype._read = function() {\n      this.x = this._io.readF4le();\n      this.y = this._io.readF4le();\n      this.z = this._io.readF4le();\n      this.owner = this._io.readS2le();\n      this.hide = this._io.readU2le();\n    }\n  \n    return Vertex;\n  })();\n  return Vertex;\n  }));\n  ","// This is a generated file! Please edit source .ksy file and use kaitai-struct-compiler to rebuild\nconst define = undefined; // IRA\n\n(function (root, factory) {\n    if (typeof define === 'function' && define.amd) {\n      define(['kaitai-struct/KaitaiStream'], factory);\n    } else if (typeof module === 'object' && module.exports) {\n      module.exports = factory(require('kaitai-struct/KaitaiStream'));\n    } else {\n      root.Face = factory(root.KaitaiStream);\n    }\n  }(this, function (KaitaiStream) {\n  /**\n   * @see {@link https://carnivores.fandom.com/wiki/3DF|Source}\n   */\n  \n  var Face = (function() {\n    function Face(_io, _parent, _root) {\n      this._io = _io;\n      this._parent = _parent;\n      this._root = _root || this;\n  \n      this._read();\n    }\n    Face.prototype._read = function() {\n      this.v1 = this._io.readU4le();\n      this.v2 = this._io.readU4le();\n      this.v3 = this._io.readU4le();\n      this.tax = this._io.readS4le();\n      this.tbx = this._io.readS4le();\n      this.tcx = this._io.readS4le();\n      this.tay = this._io.readS4le();\n      this.tby = this._io.readS4le();\n      this.tcy = this._io.readS4le();\n      this.fDoubleSide = this._io.readBitsIntBe(1) != 0;\n      this.fDarkBack = this._io.readBitsIntBe(1) != 0;\n      this.fOpacity = this._io.readBitsIntBe(1) != 0;\n      this.fMortal = this._io.readBitsIntBe(1) != 0;\n      this.fPhong = this._io.readBitsIntBe(1) != 0;\n      this.fEnvmap = this._io.readBitsIntBe(1) != 0;\n      this.fNeedvc = this._io.readBitsIntBe(1) != 0;\n      this.fUnused = this._io.readBitsIntBe(7);\n      this.fDarkFront = this._io.readBitsIntBe(1) != 0;\n      this._io.alignToByte();\n      this.dMask = this._io.readU2le();\n      this.distant = this._io.readS4le();\n      this.next = this._io.readU4le();\n      this.group = this._io.readU4le();\n      this.reserved = this._io.readBytes(12);\n    }\n  \n    return Face;\n  })();\n  return Face;\n  }));\n  ","import KaitaiStream from 'kaitai-struct/KaitaiStream';\nimport {\n    BufferGeometry,\n    DataTexture,\n    DataTexture2DArray,\n    Float32BufferAttribute,\n    Group,\n    InstancedMesh,\n    Matrix4,\n    Mesh,\n    MeshBasicMaterial,\n    PlaneBufferGeometry,\n    RepeatWrapping,\n    RGBAFormat,\n    RGBFormat,\n    SphereBufferGeometry,\n    UnsignedByteType,\n    UnsignedShort565Type,\n    UnsignedShort5551Type,\n    RGBIntegerFormat,\n    RGIntegerFormat,\n} from 'three';\n\nimport MAP from '../kaitai/Map';\nimport RSC from '../kaitai/Rsc';\n\nconst areaPath = 'HUNTDAT/AREAS';\n\nfunction createTextureArray(rsc: any) {\n    // create data array\n    const data = new Uint16Array(rsc.textureCount * rsc.textures[0].width * rsc.textures[0].height);\n\n    // copy texture data\n    let offset = 0;\n    for (let i = 0; i < rsc.textureCount; i++) {\n        for (let j = 0; j < rsc.textures[0].width * rsc.textures[0].height; j++) {\n            // read RGBA5551...\n            let pixel = (rsc.textures[i].data[j*2+1] << 8) | rsc.textures[i].data[j*2];\n            let r = (pixel >> 10) & 0x1f;\n            let g = ((pixel >>  5) & 0x1f) << 1;\n            let b = (pixel >>  0) & 0x1f;\n            // write RGB565 (since we do not need transparency here)\n            data[offset++] = (r << 11) + (g << 5) + b;\n        }\n    }\n\n    let tex = new DataTexture2DArray(data, rsc.textures[0].width, rsc.textures[0].height, rsc.textureCount);\n    tex.type = UnsignedShort565Type;\n    tex.format = RGBFormat;\n    tex.wrapT = tex.wrapS = RepeatWrapping;\n    return tex;\n}\n\n\nfunction createGeometry(vertices: any[], faces: any[]) {\n    let geo = new BufferGeometry();\n    let position: number[] = [];\n    let uv: number[] = [];\n    let index: number[] = [];\n    let idx = 0;\n    faces.forEach(f => {\n        let a = f.v1, b = f.v2, c = f.v3;\n\n        position.push(vertices[a].x, vertices[a].y, vertices[a].z);\n        uv.push(f.tax / 256, f.tay / 256);\n        index.push(idx++);\n        position.push(vertices[b].x, vertices[b].y, vertices[b].z);\n        uv.push(f.tbx / 256, f.tby / 256);\n        index.push(idx++);\n        position.push(vertices[c].x, vertices[c].y, vertices[c].z);\n        uv.push(f.tcx / 256, f.tcy / 256);\n        index.push(idx++);\n    });\n\n    geo.setAttribute('position', new Float32BufferAttribute(position, 3));\n    geo.setAttribute('uv', new Float32BufferAttribute(uv, 2));\n    geo.setIndex(index);\n    geo.computeVertexNormals();\n\n    return geo;\n}\n\nfunction createTexture(texData: Uint8Array, width: number, height: number) {\n    let data = new Uint16Array(width * height);\n    let offset = 0;\n    for (let y = 0; y < height; y++) {\n      for (let x = 0; x < width; x++) {\n        const j = y * width + x;\n        let pixel = (texData[j*2+1] << 8) | texData[j*2];\n        let r = ((pixel >> 10) & 0x1f);\n        let g = ((pixel >>  5) & 0x1f);\n        let b = ((pixel >>  0) & 0x1f);\n        let a = 1; //(pixel & 0x80) ? 1 : 0; // ????\n        data[offset++] = (r << 11) + (g << 6) + (b << 1) | a;\n      }\n    }\n  \n    const tex = new DataTexture(\n        data, width, height,\n        RGBAFormat, UnsignedShort5551Type,\n    );\n    tex.needsUpdate = true;\n    return tex;\n  }\n\nfunction createInstancedModels(rsc: any, map: any, parent: Group) {\n\n    const matrices: number[][] = [];\n\n    const mapSize = map.mapSize;\n    const halfMapSize = mapSize / 2;\n\n    function getHeight(x: number, y: number) {\n        return map.heightMap[y * map.mapSize + x] * map.yScale;\n    }\n\n    const matrix = new Matrix4();\n    for (let y = 0; y < mapSize; y++) {\n        for (let x = 0; x < mapSize; x++) {\n            const obj = map.objectMap[y * mapSize + x];\n            if (obj < 254) {\n                matrix.makeTranslation(\n                    (x - halfMapSize) * map.tileSize,\n                    getHeight(x, y),\n                    (y - halfMapSize) * map.tileSize)\n                if (!matrices[obj]) {\n                    matrices[obj] = matrix.toArray();\n                } else {\n                    matrices[obj].push.apply(matrices[obj], matrix.toArray())\n                }\n            } else if (obj === 254) {\n                // Landing list\n                const indicator = new Mesh(\n                    new SphereBufferGeometry(128),\n                    new MeshBasicMaterial({ color: 0xff0000 }),\n                )\n                indicator.position.set(\n                    (x - halfMapSize) * map.tileSize,\n                    getHeight(x, y),\n                    (y - halfMapSize) * map.tileSize);\n\n                parent.add(indicator);\n            } else if (obj === 255) {\n                // empty\n            }\n        }\n    }\n\n    rsc.models.forEach((mdl: any, obj: number) => {\n        if (matrices[obj]) {\n            const count = matrices[obj].length / 16;\n            const geo = createGeometry(mdl.model.vertices, mdl.model.faces);\n            const tex = createTexture(mdl.model.textureData, mdl.model.textureWidth, mdl.model.textureHeight);\n            const mesh = new InstancedMesh(\n                geo, new MeshBasicMaterial({ map: tex, fog: true, transparent: true, alphaTest: 0.5 }),\n                count,\n            );\n            for (let i = 0; i < count; i++) {\n                matrix.fromArray(matrices[obj], i * 16)\n                mesh.setMatrixAt(i, matrix)\n            }\n            parent.add(mesh)\n        }\n    })\n}\n\nfunction buildVertexMap(map: any) {\n    const numChannels = 2;\n    const data = new Uint8Array(map.mapSize * map.mapSize * numChannels);\n    for (let i = 0; i < map.mapSize * map.mapSize; i++) {\n        data[i*numChannels+0] = map.heightMap[i]; // R\n        data[i*numChannels+1] = map.dayLightMap[i]; // G\n    }\n    let tex = new DataTexture(data, map.mapSize, map.mapSize, RGIntegerFormat, UnsignedByteType);\n    tex.internalFormat = 'RG8UI';\n    return tex;\n}\n\nfunction buildFragmentMap(map: any) {\n    const numChannels = 3;\n    const data = new Uint8Array(map.mapSize * map.mapSize * numChannels);\n    for (let i = 0; i < map.mapSize * map.mapSize; i++) {\n        const flags = map.flagsMap[i];\n        data[i*numChannels+0] = map.textureMap1[i]; // R\n        data[i*numChannels+1] = map.textureMap2[i]; // G\n        data[i*numChannels+2] = flags.fTexDirection | (flags.fReverse << 6); // B\n    }\n    let tex = new DataTexture(data, map.mapSize, map.mapSize, RGBIntegerFormat, UnsignedByteType);\n    tex.internalFormat = 'RGB8UI';\n    return tex;\n}\n\nexport async function loadArea(area: string) {\n    let scene = new Group();\n\n    const mapBuffer = await fetch(`${areaPath}/${area}.MAP`).then(body => body.arrayBuffer());\n    const rscBuffer = await fetch(`${areaPath}/${area}.RSC`).then(body => body.arrayBuffer());\n\n    const map = new MAP(new KaitaiStream(mapBuffer));\n    const rsc = new RSC(new KaitaiStream(rscBuffer), undefined, undefined, map.version);\n    console.log(rsc, map)\n\n    // Create a plane with divisions as base for map heightfield\n    const geo = new PlaneBufferGeometry(\n//            80 * map.tileSize, 80 * map.tileSize,\n//            80 - 1, 80 - 1\n        map.mapSize * map.tileSize, map.mapSize * map.tileSize,\n        map.mapSize - 1, map.mapSize - 1\n    );\n\n    // Lay it flat\n    geo.rotateX(-Math.PI / 2);\n\n    createInstancedModels(rsc, map, scene);\n\n    // World coordinates to uv transform (TODO investigate uvScaleMap/uvTransform?)\n    const heightmapMatrix = new Matrix4().multiplyMatrices(\n        new Matrix4().makeTranslation(0.5, 0, 0.5),\n        new Matrix4().makeScale(\n            1 / (map.mapSize * map.tileSize),\n            1,\n            1 / (map.mapSize * map.tileSize),\n        ),\n    );\n\n    let mat = new MeshBasicMaterial({ map: createTextureArray(rsc), fog: true });\n    console.log(mat.defines);\n    mat.defines = {\n        'MAP_SIZE': `${map.mapSize}.0`,\n        'CARNIVORES': map.version,\n        'MAP_HSCALE': `${map.yScale}.0`,\n    };\n    mat.onBeforeCompile = s => {\n        console.log(s, map, rsc)\n        // Create our (integer) data textures for\n        // fragment and vertex shader\n        let vertexMap = buildVertexMap(map);\n        let fragmentMap = buildFragmentMap(map);\n        s.uniforms['vertexMap'] = { value: vertexMap, };\n        s.uniforms['fragmentMap'] = { value: fragmentMap, };\n        s.uniforms['heightmapMatrix'] = { value: heightmapMatrix, };\n\n        // Adjust vertex shader\n        let vs = s.vertexShader;\n        vs = vs.replace('#include <common>', `\n            precision highp usampler2D;\n            uniform usampler2D vertexMap;\n            uniform mat4 heightmapMatrix;\n            varying vec4 vLighting;\n        `)\n        vs = vs.replace('#include <color_vertex>', `\n        vUv = (heightmapMatrix * modelMatrix * vec4(position, 1.0)).xz;\n        uvec4 tex = texture(vertexMap, vUv);\n        #if CARNIVORES == 1\n        float light = 1.0 - (float(tex.g) / 64.0);\n        #else\n        float light = float(tex.g) / 255.0;\n        #endif\n        vLighting = vec4(light, light, light, 1.0);\n        #include <color_vertex>\n        `)\n        vs = vs.replace('#include <begin_vertex>', `\n        #include <begin_vertex>\n        transformed.y += float(tex.r) * MAP_HSCALE;\n        `)\n        s.vertexShader = vs;\n        // Adjust the fragment shader\n        let fs = s.fragmentShader;\n        fs = fs.replace('#include <map_pars_fragment>', `\n        precision highp sampler2DArray;\n        precision highp usampler2D;\n        uniform sampler2DArray map;\n        uniform usampler2D fragmentMap;\n        varying vec4 vLighting;\n        `);\n        fs = fs.replace('#include <map_fragment>', `\n        vec2 tilePos = vUv * MAP_SIZE;\n        vec2 localTileUv = tilePos - floor(tilePos);\n        uvec4 tex = texture(fragmentMap, vUv);\n        float triside = ((1.0-localTileUv.x) - localTileUv.y);\n        diffuseColor = vLighting;\n        switch(tex.b & 3u) {\n            case 0u:\n                //diffuseColor = vec4(1.0, 1.0, 1.0, 1.0);\n                break;\n            case 1u:\n                float t = localTileUv.x;\n                localTileUv.x = localTileUv.y;\n                localTileUv.y = 1.0 - t;\n                //diffuseColor = vec4(0.5, 0.0, 0.0, 1.0);\n                break;\n            case 2u:\n                localTileUv.x = 1.0 - localTileUv.x;\n                localTileUv.y = 1.0 - localTileUv.y;\n                //diffuseColor = vec4(0.5, 0.5, 0.0, 1.0);\n                break;\n            case 3u:\n                float x = localTileUv.x;\n                localTileUv.x = 1.0 - localTileUv.y;\n                localTileUv.y = x;\n                //diffuseColor = vec4(0.0, 0.0, 1.0, 1.0);\n                break;\n        }\n        uint depth = tex.r;\n        #if CARNIVORES == 1\n        if (triside >= 0.0) {\n            depth = (tex.b & 64u) != 0u ? tex.r : tex.g;\n        } else {\n            depth = (tex.b & 64u) != 0u ? tex.g : tex.r;\n        }\n        #endif\n        #ifdef DEBUG_REVERSE_FLAG\n        if ((tex.b & 64u) != 0u) {\n            diffuseColor = vec4(0.6, 0.6, 0.6, 1.0);\n        } else {\n            diffuseColor = vec4(1.0, 1.0, 1.0, 1.0);\n        }\n        #endif\n        vec4 texelColor = texture( map, vec3(localTileUv, depth) );\n        texelColor = mapTexelToLinear( texelColor );\n        diffuseColor *= texelColor;\n        //diffuseColor = vec4(localTileUv, 0.0, 1.0);\n        `)\n        s.fragmentShader = fs;\n    }\n\n    // Okay, terrain done!\n    scene.add(new Mesh(geo, mat));\n\n    function getHeightAt(x: number, z: number) {\n        // GetLandUpH (without fReverse handling)\n        const tileSize = map.tileSize;\n        const mapSize = map.mapSize;\n        const heightMap = map.heightMap!;\n\n        x += (mapSize * tileSize) / 2;\n        z += (mapSize * tileSize) / 2;\n\n        const cx = Math.floor(x / tileSize);\n        const cy = Math.floor(z / tileSize);\n        const dx = Math.floor(x % tileSize);\n        const dy = Math.floor(z % tileSize);\n     \n        let h1 = heightMap[cy * mapSize + cx];\n        let h2 = heightMap[cy * mapSize + cx +1];\n        let h3 = heightMap[(cy + 1) * mapSize + cx +1];\n        let h4 = heightMap[(cy + 1) * mapSize + cx];\n\n        if (dx > dy) {\n            h4 = h1 + h3 - h2;\n        } else {\n            h2 = h1 + h3 - h4;\n        }\n     \n        let h = \n            (h1 * (256 - dx) + h2 * dx) * (256 - dy) +\n            (h4 * (256 - dx) + h3 * dx) * dy;\n     \n        const height =  h / 256 / 256 * map.yScale;\n        return height;\n    }\n\n    return {\n        getHeightAt,\n        group: scene\n    };\n}\n","import React from 'react'\n\nimport { useFrame } from '@react-three/fiber';\nimport { Clock, Vector3 } from 'three';\n\nconst controls = {\n    forward: false,\n    backward: false,\n    left: false,\n    right: false,\n    run: false,\n}\n\nfunction handleKeys(event: KeyboardEvent) {\n    const down = event.type === 'keydown';\n    switch(event.key.toLowerCase()) {\n        case 'w': controls.forward = down; break;\n        case 's': controls.backward = down; break;\n        case 'a': controls.left = down; break;\n        case 'd': controls.right = down; break;\n        case 'shift': controls.run = down; break;\n        default: console.log(event.key, down);\n    }\n}\n\ninterface Props {\n    getHeightAt: (x: number, z: number) => number;\n}\n\nexport default function Player({ getHeightAt }: Props) {\n    React.useEffect(() => {\n        document.addEventListener('keydown', handleKeys);\n        document.addEventListener('keyup', handleKeys);\n        return () => {\n            document.removeEventListener('keydown', handleKeys);\n            document.removeEventListener('keyup', handleKeys);\n        }\n    })\n\n    const velocity = new Vector3();\n    const direction = new Vector3();\n    const _vector = new Vector3();\n    let onGround = false;\n\n    const velocityDrag = 10.0;\n    const mass = 100.0;\n    const gravity = 9.8;\n    const speed = 7000.0;\n    const eyeHeight = 220;\n    const clock  = new Clock();\n\n    useFrame(({ camera }) => {\n        let delta = clock.getDelta();\n\n        velocity.x -= velocity.x * velocityDrag * delta;\n        velocity.z -= velocity.z * velocityDrag * delta;\n\n        velocity.y -= gravity * mass * delta;\n\n        direction.z = Number( controls.forward ) - Number( controls.backward );\n        direction.x = Number( controls.right ) - Number( controls.left );\n        direction.normalize(); // this ensures consistent movements in all directions\n\n        if ( controls.forward || controls.backward ) velocity.z -= direction.z * speed * delta;\n        if ( controls.left || controls.right ) velocity.x -= direction.x * speed * delta;\n\n        // move right\n        _vector.setFromMatrixColumn( camera.matrix, 0 );\n        camera.position.addScaledVector( _vector, - velocity.x * delta );\n\n        // move forward\n        _vector.setFromMatrixColumn( camera.matrix, 0 );\n        _vector.crossVectors( camera.up, _vector );\n        camera.position.addScaledVector( _vector, -velocity.z * delta );\n\n        // move down\n        camera.position.y += ( velocity.y * delta );\n\n        const height = getHeightAt(camera.position.x, camera.position.z);\n        if ( camera.position.y < height + eyeHeight ) {\n\n            velocity.y = 0;\n            camera.position.y = height + eyeHeight;\n\n            onGround = true;\n        }\n\n    })\n\n    return null; // No object for player, since we're using the camera\n}\n","function wrapPromise(promise: Promise<any>) {\n    let status = 'pending'\n    let response: any\n\n    const suspender = promise.then(\n        (res) => {\n            status = 'success'\n            response = res\n        },\n        (err) => {\n            status = 'error'\n            response = err\n        },\n    )\n    const read = () => {\n        switch (status) {\n            case 'pending':\n                throw suspender\n            case 'error':\n                throw response\n            default:\n                return response\n        }\n    }\n\n    return { read }\n}\n\nexport default wrapPromise\n","import React, { Suspense } from 'react'\n\nimport { Stats, OrbitControls, PointerLockControls, Html } from '@react-three/drei'\nimport { Canvas } from '@react-three/fiber'\n\nimport { loadArea } from '../legacy/hunt'\n\nimport './Home.css'\nimport Player from '../Player'\nimport wrapPromise from '../WrapPromise'\nimport { Color } from 'three'\n\nconst resource = wrapPromise(loadArea(\"AREA1\"));\n\nfunction Terrain() {\n    const { group, getHeightAt } = resource.read();\n\n    //console.log(group, getHeightAt);\n\n    return (\n        <>\n        <primitive object={group} />\n        <Player getHeightAt={getHeightAt} />\n        </>\n    )\n}\n\nexport default function Home() {\n    return (\n        <>\n            <Canvas\n                shadows\n                linear\n                camera={{\n                    position: [ 0, 12000, 12000 ],\n                    fov: 30,\n                    near: 1,\n                    far: 1000000,\n                }}\n            >\n                <Stats />\n\n                <PointerLockControls />\n\n                <Suspense fallback={<Html center>Loading, please wait</Html>}>\n                    <Terrain />\n                </Suspense>\n            </Canvas>\n        </>\n    )\n/*\n                <fog near={10*256} far={140*256} attach=\"fog\" />\n*/\n}\n","//https://medium.com/@pdx.lucasm/canvas-with-react-js-32e133c05258\nimport React from 'react';\n\ninterface CanvasProps {\n    width?: number;\n    height?: number;\n    drawContent?: (context: CanvasRenderingContext2D) => void;\n}\n\nconst Canvas: React.FC<CanvasProps> = ({drawContent, width, height, ...props}) => {\n    const canvasRef = React.useRef<HTMLCanvasElement>(null)\n\n    React.useEffect(() => {\n        const canvas = canvasRef.current\n        const context = canvas?.getContext('2d')\n        if (canvas && context) {\n            if (width !== undefined) {\n                context.canvas.width = width;\n            }\n            if (height !== undefined) {\n                context.canvas.height = height;\n            }\n            if (drawContent) {\n                drawContent(context);\n            } else {\n                context.fillStyle = '#000000'\n                context.fillRect(0, 0, context.canvas.width, context.canvas.height)\n            }\n        }\n    }, [drawContent, height, width])\n\n\n    return (\n        <canvas\n            ref={canvasRef}\n            {...props}\n        />\n    );\n}\n\nexport default Canvas;\n","import React from 'react'\n\nimport KaitaiStream from 'kaitai-struct/KaitaiStream';\nimport MAP from '../kaitai/carnivores_map';\nimport Canvas from '../components/Canvas';\n\nconst generateHeightmap = (map: any, field: string) => {\n    let imageData = new ImageData(map.mapSize, map.mapSize);\n    for (let i = 0; i < map.mapSize * map.mapSize; i++) {\n        imageData.data[i*4+0] = map[field][i];\n        imageData.data[i*4+1] = map[field][i];\n        imageData.data[i*4+2] = map[field][i];\n        imageData.data[i*4+3] = 0xff;\n    }\n    return imageData;\n}\n\nconst generateFlagsMap = (map: any, r: number, g: number, b: number) => {\n    let imageData = new ImageData(map.mapSize, map.mapSize);\n    const bitToColorChannel = (flags: number, bit: number) => ((flags & (1 << bit)) !== 0 ? 0 : 255);\n    for (let i = 0; i < map.mapSize * map.mapSize; i++) {\n        let val = map.flagsMap[i];\n        imageData.data[i*4+0] = r !== -1 ? bitToColorChannel(val, r) : 0;\n        imageData.data[i*4+1] = g !== -1 ? bitToColorChannel(val, g) : 0;\n        imageData.data[i*4+2] = b !== -1 ? bitToColorChannel(val, b) : 0;\n        imageData.data[i*4+3] = 0xff;\n    }\n    return imageData;\n}\n\ninterface BitSelectProps {\n    bitCount: number;\n    value: number;\n    onChange: (bit: number) => void;\n}\n\nconst BitSelect: React.FC<BitSelectProps> = ({\n    value = 0,\n    bitCount = 8,\n    onChange,\n}) => {\n    return (\n        <select value={value} onChange={event => onChange(parseFloat(event.target.value))}>\n            <option value=\"-1\">n/a</option>\n            {new Array(bitCount).fill(0).map((_,i) => (\n                <option key={i} value={i}>bit {i}</option>\n            ))}\n        </select>\n    )\n}\n\nexport default function MapEditor() {\n    const [ map, setMap ] = React.useState<any>(null);\n    const [ mapName, setMapName ] = React.useState<string|null>(null);\n    const [ bitR, setBitR ] = React.useState(-1);\n    const [ bitG, setBitG ] = React.useState(-1);\n    const [ bitB, setBitB ] = React.useState(-1);\n    const [ mode, setMode ] = React.useState(1);\n\n    function dragOver(ev: React.DragEvent) {\n        ev.preventDefault();\n    } \n\n    function drop(ev: React.DragEvent) {\n        ev.preventDefault();\n        if (ev.dataTransfer.files?.length) {\n            const mapName = ev.dataTransfer.files[0].name;\n            const url = URL.createObjectURL(ev.dataTransfer.files[0]);\n            // fetch URL (retrieves local file, no physical network involved)\n            fetch(url).then(body => body.arrayBuffer()).then(buf => {\n                // Create KaitaiStream and load map\n                const map = new MAP(new KaitaiStream(buf));\n                setMapName(mapName);\n                setMap(map);\n            });\n        }\n    }\n\n    const getImageData = () => {\n        let imageData: ImageData | undefined;\n\n        switch(mode) {\n            case 0: // Flags\n                imageData = generateFlagsMap(map, bitR, bitG, bitB);\n                break;\n\n            case 1: // Heightmap\n                imageData = generateHeightmap(map, 'heightMap');\n                break;\n\n            case 2: // Watertmap\n                imageData = generateHeightmap(map, 'waterMap');\n                break;\n        }\n\n        return imageData;\n    }\n\n    const drawMapContent = (ctx: CanvasRenderingContext2D) => {\n        const imageData = getImageData();\n        if (imageData) {\n            ctx.putImageData(imageData, 0, 0);\n        }\n    }\n\n    const downloadImageData = () => {\n        const imageData = getImageData();\n        if (imageData) {\n            var canvas = document.createElement('canvas');\n            var ctx = canvas.getContext(\"2d\");\n            if (ctx) {\n                ctx.canvas.width = imageData.width;\n                ctx.canvas.height = imageData.height;\n                ctx.putImageData(imageData, 0, 0);\n                var dataImage = canvas.toDataURL(\"image/png\");\n\n                let name: string = mapName?.replace(/\\.MAP$/i, '') || '';\n                switch(mode) {\n                    case 0:\n                        name += `-r${bitR}g${bitG}b${bitB}.png`;\n                        break;\n                    case 1: \n                        name += '-height.png';\n                        break;\n                    case 2: \n                        name += '-water.png';\n                        break;\n                }\n\n                const link = document.createElement('a');\n                link.setAttribute('download', name);\n                link.setAttribute('href', dataImage.replace(\"image/png\", \"image/octet-stream\"));\n                link.click();\n            }\n        }\n    }\n\n    return (\n        <div onDragOver={dragOver} onDrop={drop} style={{width: '100%', height: '100%', margin: '5px', userSelect: 'text'}}>\n            {map && mapName ? (\n                <>\n                    <h1>{mapName}</h1>\n                    <select value={mode} onChange={ev => setMode(parseInt(ev.target.value))}>\n                        <option value=\"0\">Flags</option>\n                        <option value=\"1\">Heightmap</option>\n                        <option value=\"2\">Watermap</option>\n                    </select>\n                    {\n                        mode === 0 && (\n                            <>\n                                <BitSelect value={bitR} bitCount={16} onChange={bit => setBitR(bit)} />\n                                <BitSelect value={bitG} bitCount={16} onChange={bit => setBitG(bit)} />\n                                <BitSelect value={bitB} bitCount={16} onChange={bit => setBitB(bit)} />      \n                            </>\n                        )\n                    }\n                    <button\n                        onClick={downloadImageData}\n                        >\n                            Download\n                    </button>\n                    <br/>\n                    <br/>\n                    <Canvas\n                        width={map.mapSize}\n                        height={map.mapSize}\n                        drawContent={drawMapContent}\n                    />\n                </>\n            ) : (\n                <h1>Drop a Carnivores 1/2/IceAge MAP file here</h1>\n            )}\n        </div>\n    )\n}","import React from 'react'\n\nexport default function ModelEditor() {\n    return (\n        <div />\n    )\n}","import React from 'react'\n\nimport {\n  HashRouter as Router,\n  Switch,\n  Route,\n} from 'react-router-dom';\n\nimport Home from './pages/Home';\nimport MapEditor from './pages/MapEditor';\nimport ModelEditor from './pages/ModelEditor';\n\nexport default function App() {\n  return (\n    <Router>\n      <Switch>\n        <Route exact path=\"/\">\n          <Home />\n        </Route>\n        <Route path=\"/edit-map\">\n          <MapEditor />\n        </Route>\n        <Route path=\"/edit-model\">\n          <ModelEditor />\n        </Route>\n      </Switch>\n    </Router>\n  )\n}\n","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n","// This is a generated file! Please edit source .ksy file and use kaitai-struct-compiler to rebuild\nconst define = undefined, self = undefined;\n(function (root, factory) {\n  if (typeof define === 'function' && define.amd) {\n    define(['kaitai-struct/KaitaiStream'], factory);\n  } else if (typeof module === 'object' && module.exports) {\n    module.exports = factory(require('kaitai-struct/KaitaiStream'));\n  } else {\n    root.Map = factory(root.KaitaiStream);\n  }\n}(typeof self !== 'undefined' ? self : this, function (KaitaiStream) {\n/**\n * @see {@link https://carnivores.fandom.com/wiki/Carnivores_2_MAP|Source}\n */\n\nvar Map = (function() {\n  function Map(_io, _parent, _root) {\n    this._io = _io;\n    this._parent = _parent;\n    this._root = _root || this;\n\n    this._read();\n  }\n  Map.prototype._read = function() {\n    this.heightMap = new Array((this.mapSize * this.mapSize));\n    for (var i = 0; i < (this.mapSize * this.mapSize); i++) {\n      this.heightMap[i] = this._io.readU1();\n    }\n    this.textureMap1 = new Array((this.mapSize * this.mapSize));\n    for (var i = 0; i < (this.mapSize * this.mapSize); i++) {\n      switch (this.version) {\n      case 1:\n        this.textureMap1[i] = this._io.readU1();\n        break;\n      case 2:\n        this.textureMap1[i] = this._io.readU2le();\n        break;\n      }\n    }\n    this.textureMap2 = new Array((this.mapSize * this.mapSize));\n    for (var i = 0; i < (this.mapSize * this.mapSize); i++) {\n      switch (this.version) {\n      case 1:\n        this.textureMap2[i] = this._io.readU1();\n        break;\n      case 2:\n        this.textureMap2[i] = this._io.readU2le();\n        break;\n      }\n    }\n    this.objectMap = this._io.readBytes((this.mapSize * this.mapSize));\n    this.flagsMap = new Array((this.mapSize * this.mapSize));\n    for (var i = 0; i < (this.mapSize * this.mapSize); i++) {\n      switch (this.version) {\n      case 1:\n        this.flagsMap[i] = new FlagsV1(this._io, this, this._root);\n        break;\n      case 2:\n        this.flagsMap[i] = new FlagsV2(this._io, this, this._root);\n        break;\n      }\n    }\n    if (this.version == 2) {\n      this.dawnLightMap = this._io.readBytes((this.mapSize * this.mapSize));\n    }\n    this.dayLightMap = this._io.readBytes((this.mapSize * this.mapSize));\n    if (this.version == 2) {\n      this.nightLightMap = this._io.readBytes((this.mapSize * this.mapSize));\n    }\n    this.waterMap = this._io.readBytes((this.mapSize * this.mapSize));\n    this.objectHeightMap = this._io.readBytes((this.mapSize * this.mapSize));\n    this.fogsMap = this._io.readBytes(Math.floor((this.mapSize * this.mapSize) / 4));\n    this.ambientMap = this._io.readBytes(Math.floor((this.mapSize * this.mapSize) / 4));\n  }\n\n  var FlagsV1 = Map.FlagsV1 = (function() {\n    function FlagsV1(_io, _parent, _root) {\n      this._io = _io;\n      this._parent = _parent;\n      this._root = _root || this;\n\n      this._read();\n    }\n    FlagsV1.prototype._read = function() {\n      this.fTexDirection = this._io.readBitsIntLe(2);\n      this.fModelDirection = this._io.readBitsIntLe(3);\n      this.fNoWay = this._io.readBitsIntLe(1) != 0;\n      this.fReverse = this._io.readBitsIntLe(1) != 0;\n      this.fWater = this._io.readBitsIntLe(1) != 0;\n    }\n\n    /**\n     * 0: no rotation (right-side-up)\n     * 1: rotated 90 degrees clockwise\n     * 2: rotated 180 degrees (upside-down)\n     * 3: rotated 90 degrees counter-clockwise\n     */\n\n    /**\n     * Represents an angle, fully calculated as\n     * (value * 2 * PI / 8) and used when rendering models on the tile.\n     */\n\n    /**\n     * Indicates how the cell is diagonally split among both textures\n     *   true: 2 - 1\n     *   false: 1 - 2\n     */\n\n    /**\n     * Marks the cell as having water in it, must be set for the Water Index\n     * map to have any effect.\n     */\n\n    return FlagsV1;\n  })();\n\n  var FlagsV2 = Map.FlagsV2 = (function() {\n    function FlagsV2(_io, _parent, _root) {\n      this._io = _io;\n      this._parent = _parent;\n      this._root = _root || this;\n\n      this._read();\n    }\n    FlagsV2.prototype._read = function() {\n      this.fTexDirection = this._io.readBitsIntLe(2);\n      this.fModelDirection = this._io.readBitsIntLe(2);\n      this.fReverse = this._io.readBitsIntLe(1) != 0;\n      this.fNoWay = this._io.readBitsIntLe(1) != 0;\n      this.unused1 = this._io.readBitsIntLe(1) != 0;\n      this.fWater = this._io.readBitsIntLe(1) != 0;\n      this.fTex2Direction = this._io.readBitsIntLe(2);\n      this.unused2 = this._io.readBitsIntLe(5);\n      this.fWater2 = this._io.readBitsIntLe(1) != 0;\n    }\n\n    /**\n     * 0: no rotation (right-side-up)\n     * 1: rotated 90 degrees clockwise\n     * 2: rotated 180 degrees (upside-down)\n     * 3: rotated 90 degrees counter-clockwise\n     */\n\n    /**\n     * Represents an angle, fully calculated as\n     * (value * 2 * PI / 4) and used when rendering models on the tile.\n     */\n\n    /**\n     * Indicates how the cell is diagonally split among both textures\n     *   true: 2 - 1\n     *   false: 1 - 2\n     */\n\n    return FlagsV2;\n  })();\n  Object.defineProperty(Map.prototype, 'mapSize', {\n    get: function() {\n      if (this._m_mapSize !== undefined)\n        return this._m_mapSize;\n      this._m_mapSize = (this.version * 512);\n      return this._m_mapSize;\n    }\n  });\n  Object.defineProperty(Map.prototype, 'yScale', {\n    get: function() {\n      if (this._m_yScale !== undefined)\n        return this._m_yScale;\n      this._m_yScale = (this.version * 32);\n      return this._m_yScale;\n    }\n  });\n  Object.defineProperty(Map.prototype, 'version', {\n    get: function() {\n      if (this._m_version !== undefined)\n        return this._m_version;\n      this._m_version = (this._io.size == 2228224 ? 1 : (this._io.size == 14155776 ? 2 : 0));\n      return this._m_version;\n    }\n  });\n  Object.defineProperty(Map.prototype, 'tileSize', {\n    get: function() {\n      if (this._m_tileSize !== undefined)\n        return this._m_tileSize;\n      this._m_tileSize = 256;\n      return this._m_tileSize;\n    }\n  });\n  Object.defineProperty(Map.prototype, 'isValid', {\n    get: function() {\n      if (this._m_isValid !== undefined)\n        return this._m_isValid;\n      this._m_isValid =  ((this.version == 1) || (this.version == 2)) ;\n      return this._m_isValid;\n    }\n  });\n\n  /**\n   * Terrain heightmap\n   * \n   * The terrain geometry is a `map_size`x`map_size` grid of 256x256\n   * tiles, where the integer height from the heightmap is multiplied by 32\n   * for the original Carnivores, and 64 for Carnivores 2 and Ice Age.\n   */\n\n  /**\n   * Textur map 1\n   * \n   * In the original Carnivores, this specifies the texture to on the\n   * first* triangle of a tile. For Carnivores 2 and Ice Age, the texture\n   * specified here is used for the entire tile.\n   * \n   * Triangle order (for original Carnivores):\n   * +-----+\n   * | \\ 1 |\n   * |  \\  |\n   * | 2 \\ |\n   * +-----+\n   */\n\n  /**\n   * Texture map 2\n   * \n   * In the original Carnivores, this specifies the texture of the second\n   * triangle of a tile. For Carnivores 2 and Ice Age, the texture specified\n   * here is used for a 4x4 tile in the distance (aka LOD texture).\n   */\n\n  /**\n   * Object map\n   * \n   * This map specifies if an object is placed on a tile, and if so, which\n   * one. The following values are used:\n   * \n   *   < 254: object index (see RSC file format)\n   *     254: spawn location (or trophy placement location for trophy room)\n   *     255: no object\n   */\n\n  /**\n   * Map of flags per tile. different between original and 2 / Ice Age!\n   */\n\n  /**\n   * Water heightmap\n   * Only read when the water flag is set for a tile.\n   * Specifies sea floor height.\n   */\n\n  /**\n   * Object heightmap\n   * \n   * Map of heights for tiles with objects. However, it is only used when\n   * the object flags in the RSC file specify place_user (other options there\n   * are place_ground or place_water).\n   */\n\n  /**\n   * Fog map, which areas are covered in fog in game.\n   */\n\n  /**\n   * Ambient sounds map\n   */\n\n  return Map;\n})();\nreturn Map;\n}));\n","// This is a generated file! Please edit source .ksy file and use kaitai-struct-compiler to rebuild\nconst define = undefined, self = undefined;\n(function (root, factory) {\n  if (typeof define === 'function' && define.amd) {\n    define(['kaitai-struct/KaitaiStream', './C3df'], factory);\n  } else if (typeof module === 'object' && module.exports) {\n    module.exports = factory(require('kaitai-struct/KaitaiStream'), require('./C3df'));\n  } else {\n    root.Rsc = factory(root.KaitaiStream, root.C3df);\n  }\n}(typeof self !== 'undefined' ? self : this, function (KaitaiStream, C3df) {\n/**\n * @see {@link https://www.tapatalk.com/groups/the_carnivores_saga/carnivores-2-and-ice-age-rsc-files-t2316.html|Source}\n */\n\nvar Rsc = (function() {\n  Rsc.AudioReverb = Object.freeze({\n    GENERIC: 0,\n    PLATE: 1,\n    FOREST: 2,\n    MOUNTAIN: 3,\n    CANYON: 4,\n    CAVE: 5,\n    SPECIAL2: 6,\n    UNUSED: 7,\n\n    0: \"GENERIC\",\n    1: \"PLATE\",\n    2: \"FOREST\",\n    3: \"MOUNTAIN\",\n    4: \"CANYON\",\n    5: \"CAVE\",\n    6: \"SPECIAL2\",\n    7: \"UNUSED\",\n  });\n\n  function Rsc(_io, _parent, _root, version) {\n    this._io = _io;\n    this._parent = _parent;\n    this._root = _root || this;\n    this.version = version;\n\n    this._read();\n  }\n  Rsc.prototype._read = function() {\n    this.textureCount = this._io.readU4le();\n    this.modelCount = this._io.readU4le();\n    if (this.version == 2) {\n      this.dawnSkyRgb = new Rgb(this._io, this, this._root);\n    }\n    this.daySkyRgb = new Rgb(this._io, this, this._root);\n    if (this.version == 2) {\n      this.nightSkyRgb = new Rgb(this._io, this, this._root);\n    }\n    if (this.version == 2) {\n      this.dawnSkyTRgb = new Rgb(this._io, this, this._root);\n    }\n    this.daySkyTRgb = new Rgb(this._io, this, this._root);\n    if (this.version == 2) {\n      this.nightSkyTRgb = new Rgb(this._io, this, this._root);\n    }\n    this.textures = new Array(this.textureCount);\n    for (var i = 0; i < this.textureCount; i++) {\n      this.textures[i] = new Texture(this._io, this, this._root);\n    }\n    this.models = new Array(this.modelCount);\n    for (var i = 0; i < this.modelCount; i++) {\n      this.models[i] = new Model(this._io, this, this._root);\n    }\n    if (this.version == 2) {\n      this.dawnSkyTexture = this._io.readBytes(((this.skyTextureWidth * this.skyTextureHeight) * 2));\n    }\n    this.daySkyTexture = this._io.readBytes(((this.skyTextureWidth * this.skyTextureHeight) * 2));\n    if (this.version == 2) {\n      this.nightSkyTexture = this._io.readBytes(((this.skyTextureWidth * this.skyTextureHeight) * 2));\n    }\n    this.cloudsMap = this._io.readBytes((128 * 128));\n    this.fogCount = this._io.readU4le();\n    this.fogList = new Array(this.fogCount);\n    for (var i = 0; i < this.fogCount; i++) {\n      this.fogList[i] = new FogEntry(this._io, this, this._root);\n    }\n    this.randomSoundCount = this._io.readU4le();\n    this.randomSounds = new Array(this.randomSoundCount);\n    for (var i = 0; i < this.randomSoundCount; i++) {\n      this.randomSounds[i] = new RandomSound(this._io, this, this._root);\n    }\n    this.ambientSoundCount = this._io.readU4le();\n    this.ambientSounds = new Array(this.ambientSoundCount);\n    for (var i = 0; i < this.ambientSoundCount; i++) {\n      this.ambientSounds[i] = new AmbientSound(this._io, this, this._root);\n    }\n    if (this.version == 2) {\n      this.waterCount = this._io.readU4le();\n    }\n    if (this.version == 2) {\n      this.waters = new Array(this.waterCount);\n      for (var i = 0; i < this.waterCount; i++) {\n        this.waters[i] = new Water(this._io, this, this._root);\n      }\n    }\n  }\n\n  var Rgb = Rsc.Rgb = (function() {\n    function Rgb(_io, _parent, _root) {\n      this._io = _io;\n      this._parent = _parent;\n      this._root = _root || this;\n\n      this._read();\n    }\n    Rgb.prototype._read = function() {\n      this.r = this._io.readU4le();\n      this.g = this._io.readU4le();\n      this.b = this._io.readU4le();\n    }\n\n    return Rgb;\n  })();\n\n  var Model = Rsc.Model = (function() {\n    function Model(_io, _parent, _root) {\n      this._io = _io;\n      this._parent = _parent;\n      this._root = _root || this;\n\n      this._read();\n    }\n    Model.prototype._read = function() {\n      this.radius = this._io.readS4le();\n      this.yLo = this._io.readS4le();\n      this.yHi = this._io.readS4le();\n      this.lineLength = this._io.readS4le();\n      this.lIntensity = this._io.readS4le();\n      this.circleRad = this._io.readS4le();\n      this.cIntensity = this._io.readS4le();\n      this.fPlaceWater = this._io.readBitsIntLe(1) != 0;\n      this.fPlaceGround = this._io.readBitsIntLe(1) != 0;\n      this.fPlaceUser = this._io.readBitsIntLe(1) != 0;\n      this.fCircle = this._io.readBitsIntLe(1) != 0;\n      this.fBound = this._io.readBitsIntLe(1) != 0;\n      this.fNoBmp = this._io.readBitsIntLe(1) != 0;\n      this.fNoLight = this._io.readBitsIntLe(1) != 0;\n      this.fDefaultLight = this._io.readBitsIntLe(1) != 0;\n      this.fGroundLight = this._io.readBitsIntLe(1) != 0;\n      this.fNoSoft = this._io.readBitsIntLe(1) != 0;\n      this.fNoSoft2 = this._io.readBitsIntLe(1) != 0;\n      this.fUnused = this._io.readBitsIntLe(20);\n      this.fIsAnimated = this._io.readBitsIntLe(1) != 0;\n      this._io.alignToByte();\n      this.grRad = this._io.readS4le();\n      this.refLight = this._io.readS4le();\n      this.lastAniTime = this._io.readU4le();\n      this.boundR = this._io.readF4le();\n      this.reserved = this._io.readBytes(16);\n      this.model = new C3df(this._io, this, null);\n      if (this._root.version == 2) {\n        this.billboard = new Texture(this._io, this, this._root);\n      }\n      if (this.fIsAnimated) {\n        this.animation = new ModelAnimation(this._io, this, this._root);\n      }\n    }\n\n    return Model;\n  })();\n\n  var Trd = Rsc.Trd = (function() {\n    function Trd(_io, _parent, _root) {\n      this._io = _io;\n      this._parent = _parent;\n      this._root = _root || this;\n\n      this._read();\n    }\n    Trd.prototype._read = function() {\n      this.rNumber = this._io.readU4le();\n      this.rVolume = this._io.readU4le();\n      this.rFrequency = this._io.readU4le();\n      this.rEnvironment = this._io.readU2le();\n      this.rfNotAtNight = this._io.readBitsIntLe(1) != 0;\n      this.rfUnused = this._io.readBitsIntLe(15);\n    }\n\n    /**\n     * if set, sound does not play at night\n     */\n\n    return Trd;\n  })();\n\n  var ModelAnimation = Rsc.ModelAnimation = (function() {\n    function ModelAnimation(_io, _parent, _root) {\n      this._io = _io;\n      this._parent = _parent;\n      this._root = _root || this;\n\n      this._read();\n    }\n    ModelAnimation.prototype._read = function() {\n      this.vc0 = this._io.readU4le();\n      this.vc1 = this._io.readU4le();\n      this.vc2 = this._io.readU4le();\n      this.kps = this._io.readU4le();\n      this.frameCount = this._io.readU4le();\n      this.frames = new Array(((this.frameCount * 3) * this.vc1));\n      for (var i = 0; i < ((this.frameCount * 3) * this.vc1); i++) {\n        this.frames[i] = this._io.readS2le();\n      }\n    }\n\n    return ModelAnimation;\n  })();\n\n  var Water = Rsc.Water = (function() {\n    function Water(_io, _parent, _root) {\n      this._io = _io;\n      this._parent = _parent;\n      this._root = _root || this;\n\n      this._read();\n    }\n    Water.prototype._read = function() {\n      this.textureIndex = this._io.readU4le();\n      this.level = this._io.readU4le();\n      this.opacity = this._io.readF4le();\n      this.fogRgb = this._io.readU4le();\n    }\n\n    return Water;\n  })();\n\n  var FogEntry = Rsc.FogEntry = (function() {\n    function FogEntry(_io, _parent, _root) {\n      this._io = _io;\n      this._parent = _parent;\n      this._root = _root || this;\n\n      this._read();\n    }\n    FogEntry.prototype._read = function() {\n      this.fogRgb = this._io.readU4le();\n      this.yBegin = this._io.readF4le();\n      this.mortal = this._io.readU4le();\n      this.transp = this._io.readF4le();\n      this.fLimit = this._io.readF4le();\n    }\n\n    return FogEntry;\n  })();\n\n  var AmbientSound = Rsc.AmbientSound = (function() {\n    function AmbientSound(_io, _parent, _root) {\n      this._io = _io;\n      this._parent = _parent;\n      this._root = _root || this;\n\n      this._read();\n    }\n    AmbientSound.prototype._read = function() {\n      this.pcmSize = this._io.readU4le();\n      this.pcm = this._io.readBytes(this.pcmSize);\n      this.rData = new Array(16);\n      for (var i = 0; i < 16; i++) {\n        this.rData[i] = new Trd(this._io, this, this._root);\n      }\n      this.rsfxCount = this._io.readU4le();\n      this.aVolume = this._io.readU4le();\n    }\n\n    return AmbientSound;\n  })();\n\n  var RandomSound = Rsc.RandomSound = (function() {\n    function RandomSound(_io, _parent, _root) {\n      this._io = _io;\n      this._parent = _parent;\n      this._root = _root || this;\n\n      this._read();\n    }\n    RandomSound.prototype._read = function() {\n      this.pcmSize = this._io.readU4le();\n      this.pcm = this._io.readBytes(this.pcmSize);\n    }\n\n    return RandomSound;\n  })();\n\n  var Texture = Rsc.Texture = (function() {\n    function Texture(_io, _parent, _root) {\n      this._io = _io;\n      this._parent = _parent;\n      this._root = _root || this;\n\n      this._read();\n    }\n    Texture.prototype._read = function() {\n      this.data = this._io.readBytes(((this.width * this.height) * 2));\n    }\n    Object.defineProperty(Texture.prototype, 'width', {\n      get: function() {\n        if (this._m_width !== undefined)\n          return this._m_width;\n        this._m_width = 128;\n        return this._m_width;\n      }\n    });\n    Object.defineProperty(Texture.prototype, 'height', {\n      get: function() {\n        if (this._m_height !== undefined)\n          return this._m_height;\n        this._m_height = 128;\n        return this._m_height;\n      }\n    });\n\n    /**\n     * raw RGBA5551 bitmap data\n     */\n\n    return Texture;\n  })();\n  Object.defineProperty(Rsc.prototype, 'skyTextureWidth', {\n    get: function() {\n      if (this._m_skyTextureWidth !== undefined)\n        return this._m_skyTextureWidth;\n      this._m_skyTextureWidth = 256;\n      return this._m_skyTextureWidth;\n    }\n  });\n  Object.defineProperty(Rsc.prototype, 'skyTextureHeight', {\n    get: function() {\n      if (this._m_skyTextureHeight !== undefined)\n        return this._m_skyTextureHeight;\n      this._m_skyTextureHeight = 256;\n      return this._m_skyTextureHeight;\n    }\n  });\n\n  return Rsc;\n})();\nreturn Rsc;\n}));\n","// This is a generated file! Please edit source .ksy file and use kaitai-struct-compiler to rebuild\n/* eslint-disable */\n(function (root, factory) {\n  if (typeof define === 'function' && define.amd) {\n    define(['kaitai-struct/KaitaiStream'], factory);\n  } else if (typeof module === 'object' && module.exports) {\n    module.exports = factory(require('kaitai-struct/KaitaiStream'));\n  } else {\n    root.Carnivores1Map = factory(root.KaitaiStream);\n  }\n}(this, function (KaitaiStream) {\nvar Carnivores1Map = (function() {\n  function Carnivores1Map(_io, _parent, _root) {\n    this._io = _io;\n    this._parent = _parent;\n    this._root = _root || this;\n\n    this._read();\n  }\n  Carnivores1Map.prototype._read = function() {\n    this.heightMap = this._io.readBytes((this.mapSize * this.mapSize));\n    this.textureMap1 = new Array((this.mapSize * this.mapSize));\n    for (var i = 0; i < (this.mapSize * this.mapSize); i++) {\n      switch (this.isV1) {\n      case true:\n        this.textureMap1[i] = this._io.readU1();\n        break;\n      case false:\n        this.textureMap1[i] = this._io.readU2le();\n        break;\n      }\n    }\n    this.textureMap2 = new Array((this.mapSize * this.mapSize));\n    for (var i = 0; i < (this.mapSize * this.mapSize); i++) {\n      switch (this.isV1) {\n      case true:\n        this.textureMap2[i] = this._io.readU1();\n        break;\n      case false:\n        this.textureMap2[i] = this._io.readU2le();\n        break;\n      }\n    }\n    this.objectMap = this._io.readBytes((this.mapSize * this.mapSize));\n    this.flagsMap = new Array((this.mapSize * this.mapSize));\n    for (var i = 0; i < (this.mapSize * this.mapSize); i++) {\n      switch (this.isV1) {\n      case true:\n        this.flagsMap[i] = this._io.readU1();\n        break;\n      case false:\n        this.flagsMap[i] = this._io.readU2le();\n        break;\n      }\n    }\n    if (this.isV1) {\n      this.lightMap = this._io.readBytes((this.mapSize * this.mapSize));\n    }\n    if (this.isV2) {\n      this.dawnLightMap = this._io.readBytes((this.mapSize * this.mapSize));\n    }\n    if (this.isV2) {\n      this.dayLightMap = this._io.readBytes((this.mapSize * this.mapSize));\n    }\n    if (this.isV2) {\n      this.nightLightMap = this._io.readBytes((this.mapSize * this.mapSize));\n    }\n    this.waterMap = this._io.readBytes((this.mapSize * this.mapSize));\n    this.objectHeightMap = this._io.readBytes((this.mapSize * this.mapSize));\n    this.fogsMap = this._io.readBytes(Math.floor((this.mapSize * this.mapSize) / 4));\n    this.ambientMap = this._io.readBytes(Math.floor((this.mapSize * this.mapSize) / 4));\n  }\n  Object.defineProperty(Carnivores1Map.prototype, 'isV1', {\n    get: function() {\n      if (this._m_isV1 !== undefined)\n        return this._m_isV1;\n      this._m_isV1 = this._io.size == 2228224;\n      return this._m_isV1;\n    }\n  });\n  Object.defineProperty(Carnivores1Map.prototype, 'isV2', {\n    get: function() {\n      if (this._m_isV2 !== undefined)\n        return this._m_isV2;\n      this._m_isV2 = this._io.size == 14155776;\n      return this._m_isV2;\n    }\n  });\n  Object.defineProperty(Carnivores1Map.prototype, 'isValid', {\n    get: function() {\n      if (this._m_isValid !== undefined)\n        return this._m_isValid;\n      this._m_isValid =  ((this.isV1) || (this.isV2)) ;\n      return this._m_isValid;\n    }\n  });\n  Object.defineProperty(Carnivores1Map.prototype, 'mapSize', {\n    get: function() {\n      if (this._m_mapSize !== undefined)\n        return this._m_mapSize;\n      this._m_mapSize = (this.isV1 ? 512 : 1024);\n      return this._m_mapSize;\n    }\n  });\n\n  /**\n   * Terrain heightmap, for water tiles it specifies the water surface height\n   */\n\n  /**\n   * Terrain texture map, every byte specifies a texture index for the terrain\n   */\n\n  /**\n   * Object placement map, every byte specifies an object (< 254), a spawn location (254), or no model (255)\n   */\n\n  /**\n   * Flags map, specifies render flags per tile. This includes rotation of terrain texture, of object, and more.\n   */\n\n  /**\n   * Light map, specifies lighting of placed objects\n   */\n\n  /**\n   * Water heightmap, specifies \"sea floor\" terrain heights\n   */\n\n  /**\n   * Object heightmap, height placement of objects (flags map can specify to align to sea floor level or terrain ground level too)\n   */\n\n  /**\n   * Fog map, which areas are covered in fog in game.\n   */\n\n  /**\n   * Ambient sounds map\n   */\n\n  return Carnivores1Map;\n})();\nreturn Carnivores1Map;\n}));\n"],"sourceRoot":""}